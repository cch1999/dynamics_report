<!DOCTYPE HTML>
<!--
	Stellar by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Protein Dynamics - Introduction</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->

					<header id="header">
						<h1>Introduction</h1>
					</header>


				<!-- Nav -->
					<nav id="nav">
						<ul>
							<li><a href="index.html#summary">Home</a></li>
							<li><a href="intro.html" class="active">Introduction</a></li>
							<li><a href="methods.html">Methods</a></li>
							<li><a href="results.html">Results</a></li>
							<li><a href="discussion.html">Discussion and Conclusion</a></li>
							<li><a href="references.html">References</a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

							
							<!-- intro-->
							<section id="intro" class="main">
								<div class="spotlight">
									<div class="content">

										<h3><b>Section Contents</b></h3>

										<ol style="text-align: left">
											<li><a href="#biological"><b>Biological background</b></a></li>
											<li><a href="#ml"><b>Machine learning background</b></a></li>
											<li><a href="#related"><b>Related work</b></a></li>
											<li><a href="#aims"><b>Aims and motivations</b></a></li>
										</ol>

										<h3 id="biological"><b>Biological background</b></h3>

										<p>The early development of X-ray crystallography (<span class="tooltip">Ameh 2019<span class="tooltiptext">Ameh, E. (2019), <i>‘A review of basic crystallography and x-ray diffraction applications’</i>, The International Journal of Advanced Manufacturing Technology 105(7), 3289–3302, <a href="https://doi.org/10.1007/s00170-019-04508-1">doi.org/10.1007/s00170-019-04508-1</a></span></span>, <span class="tooltip">Blundell et al. 1971<span class="tooltiptext">Blundell, T., Dodson, G., Dodson, E., Hodgkin, D. & Vijayan, M. (1971), <i>X-ray analysis and the structure of insulin</i>, in ‘Proceedings of the 1970 Laurentian Hormone Conference’, Elsevier, pp. 1–40, <a href="https://doi.org/10.1016/B978-0-12-571127-2.50025-0">doi.org/10.1016/B978-0-12-571127-2.50025-0</a>.</span></span>) as a means of determining the structure of proteins meant that most work in structural biology in the 20th century tried to explain the functions of proteins by considering them as static structures (<span class="tooltip">Karplus & McCammon 1986<span class="tooltiptext"></span></span>). However, recent decades have seen a shift towards a greater appreciation for the role that dynamics plays in determining protein function (<span class="tooltip">Zhao 2013<span class="tooltiptext">Zhao, Q. (2013), <i>‘Nature of protein dynamics and thermodynamics’</i>, Reviews in Theoretical Science 1(1), 83–101, <a href="https://doi.org/10.1166/rits.2013.1005">doi.org/10.1166/rits.2013.1005</a>.</span></span>, <span class="tooltip">Doniach & Eastman 1999<span class="tooltiptext">Doniach, S. & Eastman, P. (1999), ‘Protein dynamics simulations from nanoseconds to microseconds’, Current Opinion in Structural Biology 9(2), 157–163, <a href="https://doi.org/10.1016/S0959-440X(99)80022-0">doi.org/10.1016/S0959-440X(99)80022-0</a>.</span></span>), largely thanks to new techniques such as protein NMR (<span class="tooltip">Sekhar & Kay 2019<span class="tooltiptext">Sekhar, A. & Kay, L. E. (2019), <i>‘An nmr view of protein dynamics in health and disease’</i>, Annual review of biophysics 48, 297–319, <a href="https://doi.org/10.1146/annurev-biophys-052118-115647">doi.org/10.1146/annurev-biophys-052118-115647</a>.</span></span>, <span class="tooltip">Ishima & Torchia 2000<span class="tooltiptext">Ishima, R. & Torchia, D. A. (2000), ‘Protein dynamics from nmr’, Nature structural biology 7(9), 740–743, <a href="https://doi.org/10.1038/78963">doi.org/10.1038/78963</a>.</span></span>) and XFELs (<span class="tooltip">Spence 2017<span class="tooltiptext">Spence, J. (2017), ‘<i>Xfels for structure and dynamics in biology’</i>, IUCrJ 4(4), 322–339, <a href="https://doi.org/10.1107/S2052252517005760">doi.org/10.1107/S2052252517005760</a>.</span></span>, <span class="tooltip">Johansson et al. 2017<span class="tooltiptext">Johansson, L. C., Stauch, B., Ishchenko, A. & Cherezov, V. (2017), <i>‘A bright future for serial femtosecond crystallography with xfels’</i>, Trends in biochemical sciences 42(9), 749–762, <a href="https://doi.org/10.1016/j.tibs.2017.06.007">doi.org/10.1016/j.tibs.2017.06.007</a>.</span></span>). Indeed, much has been made recently of intrinsically disordered proteins which do not fold into a stable structure at all, yet exhibit biological functions (<span class="tooltip">Wright & Dyson 2015<span class="tooltiptext">Wright, P. E. & Dyson, H. J. (2015), <i>‘Intrinsically disordered proteins in cellular signalling and regulation’</i>, Nature reviews Molecular cell biology 16(1), 18–29, <a href="https://doi.org/10.1038/nrm3920">doi.org/10.1038/nrm3920</a>.</span></span>, <span class="tooltip">Oldfield & Dunker 2014<span class="tooltiptext">Oldfield, C. J. & Dunker, A. K. (2014), <i>‘Intrinsically disordered proteins and intrinsically disordered protein regions’</i>, Annual review of biochemistry 83, 553–584, <a href="https://doi.org/10.1146/annurev-biochem-072711-164947">doi.org/10.1146/annurev-biochem-072711-164947</a>.</span></span>). Therefore, having accurate models of protein dynamics will be essential for almost all future work in biology, but especially drug design (<span class="tooltip">Lee et al. 2019<span class="tooltiptext">Lee, Y., Lazim, R., Macalino, S. J. Y. & Choi, S. (2019), <i>‘Importance of protein dynamics in the structure based drug discovery of class ag protein-coupled receptors (gpcrs)’</i>, Current opinion in structural biology 55, 147–153, <a href="https://doi.org/10.1016/j.sbi.2019.03.015">doi.org/10.1016/j.sbi.2019.03.015</a>.</span></span>, <span class="tooltip">Mortier et al. 2015<span class="tooltiptext">Mortier, J., Rakers, C., Bermudez, M., Murgueitio, M. S., Riniker, S. & Wolber, G. (2015), <i>‘The impact of molecular dynamics on drug design: applications for the characterization of ligand–macromolecule complexes’</i>, Drug Discovery Today 20(6), 686–702, <a href="https://doi.org/10.1016/j.drudis.2015.01.003"></a>.</span></span>, <span class="tooltip">Zhao & Caflisch 2015<span class="tooltiptext">Zhao, H. & Caflisch, A. (2015), <i>‘Molecular dynamics in drug design’</i>, European journal of medicinal chemistry 91, 4–14, <a href="https://doi.org/10.1016/j.ejmech.2014.08.004">doi.org/10.1016/j.ejmech.2014.08.004</a>.</span></span>, <span class="tooltip">Peng 2009<span class="tooltiptext">Peng, J. W. (2009), <i>‘Communication breakdown: protein dynamics and drug design’</i>, Structure 17(3), 319–320, <a href="https://doi.org/10.1016/j.str.2009.02.004">doi.org/10.1016/j.str.2009.02.004</a>.</span></span>) and understanding diseases caused by misfolding proteins, such as Alzheimer’s and Parkinson’s (<span class="tooltip">Selkoe 2004<span class="tooltiptext">Selkoe, D. J. (2004), <i>‘Cell biology of protein misfolding: the examples of alzheimer’s and parkinson’s diseases’</i>, Nature cell biology 6(11), 1054–1061, <a href="https://doi.org/10.1038/ncb1104-1054">doi.org/10.1038/ncb1104-1054</a>.</span></span>).</p>

										<p>The advances of <a href="https://deepmind.com/research/case-studies/alphafold">AlphaFold2</a> <span class="tooltip">(Jumper et al. 2020)<span class="tooltiptext">Jumper, J., Evans, R., Pritzel, A., Green, T., Figurnov, M., Tunyasuvunakool, K., Ronneberger, O., Bates, R., Zidek, A., Bridgland, A. et al. (2020), <i>‘High accuracy protein structure prediction using deep learning’</i>, <a href="https://www.predictioncenter.org/casp14/doc/presentations/2020_12_01_TS_predictor_AlphaFold2.pdf">Fourteenth Critical Assessment of Techniques for Protein Structure Prediction</a> (Abstract Book) 22, 24.</span></span> have shown that our future understanding of biology and the mechanisms of disease will be increasingly understood at the structural level <span class="tooltip">(AlQuraishi 2021)
											<span class="tooltiptext">AlQuraishi, M. (2021), <i>‘Machine learning in protein structure prediction’</i>, Current Opinion in Chemical Biology 65, 1–8, <a href="https://doi.org/10.1016/j.cbpa.2021.04.005">doi.org/10.1016/j.cbpa.2021.04.005</a>.</span></span>. Therefore, developing new ”neuralised” approaches to understand the dynamics of proteins will be of fundamental importance to solve problems at the frontiers of medicine and drug design. Indeed, the fact that a limitation of AlphaFold2 seems to be its ability to predict NMR solved structures (Jumper et al. 2020) suggests there is still much work to be done.</p>

										<h3 id="ml"><b>Machine learning background</b></h3>


										<p>Graph neural networks (GNNs) (<span class="tooltip">Battaglia et al. 2018<span class="tooltiptext">Battaglia, P. W., Hamrick, J. B., Bapst, V., Sanchez-Gonzalez, A., Zambaldi, V., Malinowski, M., Tacchetti, A., Raposo, D., Santoro, A., Faulkner, R. et al. (2018), <i>‘Relational inductive biases, deep learning, and graph networks’</i>, arXiv preprint <a href="https://arxiv.org/abs/1806.01261">arXiv:1806.01261</a> .</span></span>, <span class="tooltip">Monti et al. 2017<span class="tooltiptext">Monti, F., Boscaini, D., Masci, J., Rodola, E., Svoboda, J. & Bronstein, M. M. (2017), <i>Geometric deep learning on graphs and manifolds using mixture model cnns</i>, in ‘P<a href="https://openaccess.thecvf.com/content_cvpr_2017/html/Monti_Geometric_Deep_Learning_CVPR_2017_paper.html">roceedings of the IEEE conference on computer vision and pattern recognition</a>’, pp. 5115–5124.</span></span>), themselves a subset of <a href="https://geometricdeeplearning.com/">Geometric Deep Learning</a> (<span class="tooltip">Bronstein et al. 2017<span class="tooltiptext">Bronstein, M. M., Bruna, J., LeCun, Y., Szlam, A. & Vandergheynst, P. (2017), <i>‘Geometric deep learning: going beyond euclidean data’</i>, IEEE Signal Processing Magazine 34(4), 18–42, <a href="https://doi.org/10.1109/MSP.2017.2693418">doi.org/10.1109/MSP.2017.2693418</a></span></span>), have been used to learn complex physics before (<span class="tooltip">Sanchez-Gonzalez et al. 2020<span class="tooltiptext">Sanchez-Gonzalez, A., Godwin, J., Pfaff, T., Ying, R., Leskovec, J. & Battaglia, P. (2020), <i>Learning to simulate complex physics with graph networks</i>, in ‘<a href="https://proceedings.mlr.press/v119/sanchez-gonzalez20a.html">International Conference on Machine Learning</a>’, PMLR, pp. 8459–8468.</span></span>). However, in comparison to proteins, these have all been done on relatively homogeneous materials and little is known about the number of parameters and expressivity required to learn the dynamics of whole proteins (and protein complexes) using neural network based approaches.</p>

										<p>There has also been much recent work in developing deep learning architectures that are equivariant to rigid motions in Euclidean space (<span class="tooltip">Satorras, Hoogeboom & Welling 2021<span class="tooltiptext">Satorras, V. G., Hoogeboom, E., Fuchs, F. B., Posner, I. & Welling, M. (2021), <i>‘E(n) equivariant normalizing flows for molecule generation in 3d’</i>, arXiv preprint <a href="https://arxiv.org/abs/2105.09016">arXiv:2105.09016</a> .</span></span>, <span class="tooltip">Fuchs et al. 2020<span class="tooltiptext">Fuchs, F. B., Worrall, D. E., Fischer, V. & Welling, M. (2020), <i>‘Se (3)-transformers: 3d roto-translation equivariant attention networks’</i>, arXiv preprint <a href="https://arxiv.org/abs/2006.10503">arXiv:2006.10503</a> .</span></span>) and able to learn higher-order interactions in graph structured data (<span class="tooltip">Bodnar et al. 2021<span class="tooltiptext">Bodnar, C., Frasca, F., Wang, Y. G., Otter, N., Montu ́far, G., Lio, P. & Bronstein, M. (2021), <i>‘Weisfeiler and lehman go topological: Message passing simplicial networks’</i>, arXiv preprint <a href="https://arxiv.org/abs/2103.03212">arXiv:2103.03212</a>.</span></span>) that have yet to gain much attention in the domain of structural biology, let alone protein dynamics.</p>



										<h3 id="related"><b>Related work</b></h3>

										<p></p>
										<p>This work was motivated in large part by <span class="tooltip">Greener & Jones (2021)
											<span class="tooltiptext">
												Greener, J. G. & Jones, D. T. (2021),<br> <i>‘Differentiable molecular simulation can learn all the parameters in a coarse-grained force field for proteins’</i>,<br> bioRxiv <br>
												<a href="https://doi.org/10.1101/2021.02.05.429941"><b>
													doi:10.1101/2021.02.05.429941</b></a></span></span>
														which proposed a novel Differentiable Molecular Simulation (DMS) for proteins. Here, the authors showed that all the parameters in a conventional, course-grained force-field could be learnt using <a href="https://en.wikipedia.org/wiki/Automatic_differentiation">automatic differentiation</a> (AD). Interestingly, their loss function was simply that the overall protein structure was maintained after being passed through the learnt dynamics simulator with random initial velocities assigned to all the atoms. In other words, if the Root Mean Squared Deviation (RMSD) of all the atoms in the proteins was sufficiently low after N time steps, then the model can be considered to have learnt a form of dynamics that is analogous to that seen in native proteins.</p>

										<p</p>

										<figure id="dms">
											<img src="images/dms.png" alt="" width=800/>
											<figcaption>Figure 1: An overview of a general DMS model. The native structure is first perturbed by assigning random velocities, <i>V</i> , with temperature <i>T</i> , to all the atoms. The protein passes through a simulator, <i>s</i>, <i>N</i> number of times. s consists of a model, <i>d</i>, with parameters <i>θ</i>, that learns the dynamics of the system. The dynamics computed in dθ is passed to the <i>Update</i> function, which updates the coordinates and velocities of the atoms. The Update function can be a standard velocity integrator. After each forward pass, AD is used to refine the parameters <i>θ</i> (red).</figcaption>           
										</figure><br>
										
										<p>A generalised overview of the approach outlined in <span class="tooltip">Greener & Jones (2021)
											<span class="tooltiptext">
												Greener, J. G. & Jones, D. T. (2021),<br> <i>‘Differentiable molecular simulation can learn all the parameters in a coarse-grained force field for proteins’</i>,<br> bioRxiv <br>
												<a href="https://doi.org/10.1101/2021.02.05.429941"><b>
													doi:10.1101/2021.02.05.429941</b></a></span></span> is provided in <a href="#dms">Figure 1</a>. The learned dynamics model, dθ, can be a conventional force-field (with differentiable parameters) or a neural network. <span class="tooltip">Greener & Jones (2021)
											<span class="tooltiptext">
												Greener, J. G. & Jones, D. T. (2021),<br> <i>‘Differentiable molecular simulation can learn all the parameters in a coarse-grained force field for proteins’</i>,<br> bioRxiv <br>
												<a href="https://doi.org/10.1101/2021.02.05.429941"><b>
													doi:10.1101/2021.02.05.429941</b></a></span></span> demonstrated that all the parameters needed in a coursegrained force field could be learnt in this manner by assigning individual energy potentials for every possible atom-atom interaction that is split into 140 bins. The forces were calculated by taking the gradients between adjacent bins whilst the atoms were a certain distance apart. Due to the nature of AD requiring intermediate values of the equations to be stored, the memory requirements of the simulation scales linearly with the number of time steps and is thus the limiting factor in DMS.</p>
										
										
										<p>However, there were significant shortcomings with this approach that need to be addressed. Firstly, an inter-atomic distance matrix needs to be calculated at every step in the simulation. This incurs significant processing and memory costs which were prohibitive to training on proteins greater than 100 amino acids in length or having greater than 2000 time steps. Secondly, the model assumes that every possible atom-atom interaction will share no features and thus defines individual potentials for all of them. This leads to a large number of parameters (4,000,000+) that needs to be learnt and optimised separately leading to poor generalisation. All of these factors led to significant training times (2 months on a Nvidia Tesla V100), which is out of the scope of this project. We argue that this can be reframed as a multi-task learning problem, where we can exploit the commonalities and differences in the different types of interactions seen in proteins.</p>

										<p>The development of DMS libraries, including TorchMD (<span class="tooltip">Doerr et al. 2021<span class="tooltiptext">Doerr, S., Majewski, M., P ́erez, A., Kramer, A., Clementi, C., Noe, F., Giorgino, T. & De Fabritiis, G. (2021), <i>‘Torchmd: A deep learning framework for molecular simulations’</i>, Journal of Chemical Theory and Computation 17(4), 2355–2363.</span></span>), JAX MD (<span class="tooltip">Schoenholz & Cubuk 2019<span class="tooltiptext">Schoenholz, S. S. & Cubuk, E. D. (2019), <i>‘<a href="https://www.semanticscholar.org/paper/JAX%2C-M.D.%3A-End-to-End-Differentiable%2C-Hardware-in-Schoenholz-Cubuk/259c36d340e7e5a0d33b772faad981c64befce4b?p2df">Jax md: End-to-end differentiable, hardware accelerated, molecular dynamics in pure python</a>’</i>.</span></span>), DeePMD-kit (<span class="tooltip">Wang et al. 2018<span class="tooltiptext">Wang, H., Zhang, L., Han, J. & Weinan, E. (2018), <i>‘Deepmd-kit: A deep learning package for many body potential energy representation and molecular dynamics’</i>, Computer Physics Communications 228, 178–184, <a href="https://doi.org/10.1016/j.cpc.2018.03.016">doi.org/10.1016/j.cpc.2018.03.016</a>.</span></span>), SchNetPack (<span class="tooltip">Schutt et al. 2018<span class="tooltiptext">Schutt, K., Kessel, P., Gastegger, M., Nicoli, K., Tkatchenko, A. & Muller, K.-R. (2018), <i>‘Schnetpack: A deep learning toolbox for atomistic systems’</i>, Journal of chemical theory and computation 15(1), 448– 455, <a href="https://doi.org/10.1021/acs.jctc.8b00908">/doi.org/10.1021/acs.jctc.8b00908</a>.</span></span>) and DiffTaichi (<span class="tooltip">Hu et al. 2019<span class="tooltiptext">Hu, Y., Anderson, L., Li, T.-M., Sun, Q., Carr, N., Ragan-Kelley, J. & Durand, F. (2019), <i>‘Difftaichi: Differentiable programming for physical simulation’</i>, arXiv preprint <a href="https://arxiv.org/abs/1910.00935">arXiv:1910.00935</a> .</span></span>), will hopefully spawn much more work into learning protein dynamics using DMS.
										</p>




										<h3 id="aims"><b>Aims and motivations</b></h3>

										Thus, the aims of this work are 4 fold: <br><br>
										
										<ol style="text-align: left">
											<li>Create a DMS system that can learn the dynamics of a single protein domain by only requiring a small amount of training data.
												This is so that the techniques developed here can be transferred to other problems where there will likely be less training data
												available (e.g protein-protein and protein-drug interactions).</li>
											<li>Reducing the number of parameters that need to be learnt in the force field by leveraging the high generalising power and expressivity of modern deep learning architectures.</li>
											<li>Maintaining interpretability in the learnt dynamics by integrating our knowledge of protein dynamics into our machine learning models.</li>
											<li>Reduce the large memory requirements seen in <span class="tooltip">Greener & Jones (2021)
											<span class="tooltiptext">
												Greener, J. G. & Jones, D. T. (2021),<br> <i>‘Differentiable molecular simulation can learn all the parameters in a coarse-grained force field for proteins’</i>,<br> bioRxiv <br>
												<a href="https://doi.org/10.1101/2021.02.05.429941"><b>
													doi:10.1101/2021.02.05.429941</b></a></span></span> by using the KeOps (<span class="tooltip">Charlier et al. 2021<span class="tooltiptext">Charlier, B., Feydy, J., Glaun`es, J., Collin, F.-D. & Durif, G. (2021), <i>‘<a href="https://www.jeanfeydy.com/Papers/KeOps_NeurIPS_2020.pdf">Kernel operations on the gpu, with autodiff, without memory overflows</a>’</i>, Journal of Machine Learning Research 22(74), 1–6.</span></span>) library to calculate distance matrices <a href="background/keops.html">symbolically</a>.</li>
										</ol>

										<footer class="major">
			
											<ul class="actions special">
												<li><a href="index.html" class="button">Home</a></li>
												<li><a href="methods.html" class="button">Methods</a></li>
											</ul>
		
										</footer>
								</div>


								</div>
							</section>

							
					</div>

				<!-- Footer -->
				<footer class="major">

					<p class="copyright">&copy; Charlie Harris. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>

				</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>